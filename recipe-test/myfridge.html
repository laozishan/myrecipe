<!DOCTYPE html>
<html>
  <head>
    <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
    crossorigin="anonymous"
  />

  <link rel="stylesheet" href="navbar.css">


    <style>

.card-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        margin: 2rem ;
      }

      .ingredient-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        margin: 2rem 10rem;
      }

     

      body {
        margin: 0;
        padding: 0;
      }

      h2{
        text-align: center;
        font-size: 3rem;
        font-weight: 700;
        margin: 2rem; 
        margin-top: 8rem;
      }

      .navbar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100px;
        background-color: #fff;
        transition: background-color 0.5s ease; /* 背景色渐变过渡效果 */
        z-index: 1;
        /* box-shadow: 0 0.2rem 0.3rem rgba(0, 0, 0, 0.1); */
      }


      .button {
        height: 3rem;
        background-color: #333;
        color: #fff;
        border-radius: 10rem;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
        padding: 1.5rem 2rem;
        font-size: 1rem;
        font-weight: 500;
        margin: 0 1rem;
        /* box-shadow: 0 5px 5px 0 rgba(0, 0, 0, 0.3); */
      }

      .button:hover {
        background-color: #555;
      }

      .center {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        position: absolute;
        top: 35%;
        left: 10%;
      }

      .search-container {
        width: 50rem;
      }
      .button-container {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        margin: 0 0 8rem 0;
      }

      .form-control {
        text-indent: 1rem;
      }

 



      .search-container1 input[type="text"] {
        width: 50rem;
        height: 3rem; /* 调整搜索框的宽度 */
        border-radius: 50px; /* 设置圆角 */
        font-size: 1rem;
   
        box-shadow: 0.1rem 0.1rem 0.3rem rgba(0, 0, 0, 0.2); 
 
      }

      .search-container1 input[type="text"]::placeholder {
        font-size: 1rem;
      }



      @media (max-width: 992px) {
        .search-container {
          display: none; /* 达到 768px 宽度以下时隐藏搜索框 */
        }
        .navbar-text {
          display: none;
        }
        .nav-search{
          display: none;
        }
        .navbar img {
          display: none;
        }
      }

      .buttonthatis {
        height: 3rem;
        background-color: #999;
        width: 40rem;
        color: #fff;
        border-radius: 10rem;
        font-weight: 900;
        border: none;
        cursor: default;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
        padding: 1.5rem 2rem;
        font-size: 1.5rem;
        font-weight: 500;
        margin: 0 1rem;
        /* box-shadow: 0 5px 5px 0 rgba(0, 0, 0, 0.3); */
      }



  .active{
        background-color: #FBCD21;
        color: #333;
        cursor: pointer;
      }

      .active:hover{
        background-color: #deb629;
        color: #333;
        cursor: pointer;
      }




      
.card-options {
  display: flex;
  flex-direction: column;
  width:6rem;
  height: 6rem;
  margin:1rem;
  padding: 0.5rem;
  align-items: center;
  justify-content: center;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 20rem;
  box-shadow: 0px 0px 10px #ddd;
  transition: background-color 0.3s ease-in-out;
}
      
      .card-options:hover,.card:hover {
  background-color: #f8f8f8;
  cursor: pointer;
}
      

.card-options.selected {
  background-color: #FBCD21;
}


.category .card-options p:first-of-type {
  font-size: 3rem;
}


.category p:last-of-type {
  text-align: center;
  font-weight: 500;
}

.card-checkbox {
  display: none;
}





    </style>
  </head>

  <body>

    <div class="navbar navbar-expand-lg">
        <div class="container-fluid">
          <a
          class="navbar-brand"
          href="newhome.html"
          style="margin-left: 1rem; font-size: 2rem; width: 100px;"
        >
        <img src="logo.png"  style="width: 180%;"  alt=""></a
        >
  
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNav"
            aria-controls="navbarNav"
            aria-expanded="false"
          >
            <span class="navbar-toggler-icon"></span>
          </button>

  
          <div class="nav-search search-container1 me-auto " style="margin-left: 10rem; position: relative;" >
              <input
              id="search-input"
                type="text"
                class="form-control"
                placeholder="  Search..."
              />
              <button id="enter-button" style="border: none; background-color: transparent; position: absolute; right: 1.5rem; top: 50%; transform: translateY(-50%); color: #333;display: none;">Enter</button>
            </div>
   
  
  
  
  
          <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
            
            <ul class="navbar-nav ml-auto">
              <li class="nav-item">
                <a class="nav-link" href="player3.html">
                  <div class="button" >Get inspiration</div></a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="myfridge.html">
                  <div class="button" style="background-color: #fff; color: black; text-decoration: underline; font-weight: 600;">My fridge</div></a
                >
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div style="background-color: rgb(27, 30, 23);position: absolute; top: 0; left: 0; width: 99%; height: 100%;">
    <div style="margin-top: 4rem;"></div>

    <h2 style="color: #fff;">What's out there in your fridge?</h2>
    <div class="card-container">
    <img id='fridgeClose' src="fridge-closed.png" alt="fridge" style="width: 50%; height: 98%;object-fit: cover;  cursor: pointer;" onclick="scrollToIngredients()">
    <img id='fridgeOpen' src="fridge.png" alt="fridge" style="width: 50%; height: 98%;display:none; object-fit: cover;cursor: pointer; border: none;">
</div>
</div>

<div style="margin-top: 110vh;"></div>
    <h2 id="ingredientH2">There are...</h2>

    <div class="ingredient-container" id="ingredients-container">
</div>


<div class="button-container" style="margin: 2rem 10rem; ">
<div class=" buttonthatis notactive" id="thatis" >That's it!</div>
</div>



<div id="recipesDiv"  style="display: none;margin: 0">
    <h2 id="recipeh2">Here are recipes with your fridge ingredients!</h2>
    <div class="card-container" id="recipeContainer" style="margin: 0;">

    </div>
</div>


<h2 id="errorh2" style="display: none;"></h2>



<script>
    const ingredients = {
  "🥥": "Coconut",
  "🥦": "Broccoli",
  "🥬": "Lettuce",
  "🥝": "Kiwi",
  "🥚": "Egg",
  "🥩": "Steak",
  "🍅": "Tomato",
  "🍄": "Mushroom",
  "🥜": "Peanut",
  "🥒": "Cucumber",
  "🌶": "Chili",
  "🫑": "Bell Pepper",
  "🥑": "Avocado",
  "🧅": "Onion",
  "🥕": "Carrot",
  "🌽": "Corn",
  "🥔": "Potato",
  "🍠": "Sweet Potato",
  "🍌": "Banana",
  "🍋": "Lemon",
  "🫐": "Blueberry",
  "🍗": "Chicken",
  "🍖": "Meat",
  "🍤": "Shrimp",
  "🍚": "Rice",
  "🧀": "Cheese",
  "🌰": "Nut",
};

const container = document.getElementById("ingredients-container");


for (const emoji in ingredients) {
  const ingredientName = ingredients[emoji];

  const categoryDiv = document.createElement("div");
  categoryDiv.className = "category";

  const cardOptions = document.createElement("div");
  cardOptions.className = "card-options";

  const emojiParagraph = document.createElement("p");
  emojiParagraph.textContent = emoji;

  const checkbox = document.createElement("input");
  checkbox.type = "checkbox";
  checkbox.name = "ingredient";
  checkbox.value = ingredientName;
  checkbox.className = "card-checkbox";

  const ingredientNameParagraph = document.createElement("p");
  ingredientNameParagraph.textContent = ingredientName;

  cardOptions.appendChild(emojiParagraph);
  cardOptions.appendChild(checkbox);
  categoryDiv.appendChild(cardOptions);
  categoryDiv.appendChild(ingredientNameParagraph);
  container.appendChild(categoryDiv);
}



</script>









<script>
    fridgeClose.addEventListener('click',()=>{
        fridgeClose.style.display='none'
        fridgeOpen.style.display='flex'
    })
    fridgeOpen.addEventListener('click',()=>{
        fridgeOpen.style.display='none'
        fridgeClose.style.display='flex'
    })




function scrollToIngredients() {
  setTimeout(() => {
    const ingredientH2 = document.getElementById('ingredientH2');
    ingredientH2.scrollIntoView({ behavior: 'smooth' });
  }, 1000);
}




const cardOptions = document.querySelectorAll(".card-options");
let myIngredients;
const thatis = document.getElementById('thatis')

const recipesDiv = document.getElementById('recipesDiv')
const errorh2 = document.getElementById('errorh2')

cardOptions.forEach((card) => {
  card.addEventListener("click", () => {
    console.log("clicked");
    let selectedIngredients;
    if (card.classList.contains("selected")) {
      card.classList.remove("selected");
      card.querySelector('input[type="checkbox"]').checked = false;
    } else {
      card.classList.add("selected");
      card.querySelector('input[type="checkbox"]').checked = true;
    }

    selectedIngredients = document.querySelectorAll(
      'input[name="ingredient"]:checked'
    );
    myIngredients = Array.from(selectedIngredients).map(
      (ingredient) => ingredient.value
    );
    console.log(myIngredients);

    if(myIngredients.length>0){

        thatis.classList.add('active')
    }
    else{
        thatis.classList.remove('active')
    }
  });
});



thatis.addEventListener("click",function(event) {
  if (thatis.classList.contains('active')) {
    generateRecipe(myIngredients);
  }
      });




      async function generateRecipe(ingredients) {
        finalIngredients=ingredients.join('%2C')
        console.log(finalIngredients)

      try {
        const recipeData = await fetchRecipeData(finalIngredients);
        displayRecipes(recipeData,recipeContainer);
      } catch (error) {
        console.error('Error fetching recipe data:', error);
      }

        recipesDiv.style.display = 'block';
        window.scrollTo(0, 1600);
      }
      
      
      
      
      
      
      
      
      





async function fetchRecipeData(food) {
  let url =
    "https://spoonacular-recipe-food-nutrition-v1.p.rapidapi.com/recipes/findByIngredients?ingredients=" +
    food+'&number=30';

    url=url.replace(/ /g, "+")

    console.log(url)
  const options = {
    method: "GET",
    headers: {
      "X-RapidAPI-Key": "0ea6aa2962mshf9120b6d8aad583p189182jsn145a03b81325",
      "X-RapidAPI-Host": "spoonacular-recipe-food-nutrition-v1.p.rapidapi.com",
    },
  };

  try {
    const response = await fetch(url, options);
    const data = await response.json();
    console.log(data)
    return data;
  } catch (error) {
    console.error("API error:", error);
    return null;
  }
}

function displayRecipes(recipeData,divName) {
  // 清空之前的内容
  divName.innerHTML = "";

  if (!recipeData) {
    // 处理请求错误的情况
    errorh2.textContent = "Cannot retrive the recipes. Please try it again";
    errorh2.style.display ="block"
    return;
  }

  else if(recipeData.length==0){
    errorh2.textContent = "We didn't find recipes with all these ingredients";
    errorh2.style.display ="block"
    return;

  }

  // 创建 <div class="card-container"> 元素
  const cardContainer = document.createElement("div");
  cardContainer.className = "card-container";
  divName.appendChild(cardContainer);

  const recipes = recipeData
  console.log(recipes)
  console.log("recipes:",recipes)

  recipes.forEach((recipe) => {
    // 创建 <div class="card"> 元素
    const card = document.createElement("div");
    card.className = "card";
    cardContainer.appendChild(card);

    // 创建 <div class="image-container"> 元素
    const imageContainer = document.createElement("div");
    imageContainer.className = "image-container";
    card.appendChild(imageContainer);

    // 创建 <img> 元素
    const image = document.createElement("img");
    image.src = recipe.image;
    image.alt = recipe.title;
    imageContainer.appendChild(image);

    // 创建 <p> 元素
    const pElement = document.createElement("p");
    pElement.textContent = recipe.title;
    card.appendChild(pElement);

    card.addEventListener("click", (event) => {
        event.preventDefault();
        window.open(`details.html?id=${recipe.id}`, "_blank");
      });
  });

}


</script>












<script
src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
crossorigin="anonymous"
></script>
<script>
    var searchInput = document.getElementById('search-input');
var enterButton = document.getElementById('enter-button');

searchInput.addEventListener('input', function() {
if (searchInput.value.trim() !== '') {
enterButton.style.display = 'block';
} else {
enterButton.style.display = 'none';
}
});


enterButton.addEventListener('click',function(){
  const keyword = searchInput.value;
  const url = `searchresult.html?keyword=${encodeURIComponent(keyword)}`;
  window.location.href = url;

})


</script>
  </body>
</html>
